{% extends 'dashboard.html' %}
{% block  content%}
{% load static %}
<head>
  <title>Add Client</title>

  <style>
    .calculator-button {
        border-radius: 50%;
        width: 60px;
        height: 60px;
    }
    .calculator-button:hover {
        background-color: #f0f0f0;
    }
</style>
</head>
<div class="col-span-12 mt-8">
  <div id="loader-overlay">
      <div class="loader"></div>
  </div>
<div class="col-span-12 mt-8">
 
<!-- component -->
<link rel="stylesheet" href="https://demos.creative-tim.com/notus-js/assets/styles/tailwind.css">
<link rel="stylesheet" href="https://demos.creative-tim.com/notus-js/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css">

<div class="col-span-12 mt-8">
<section class="py-1">

        <div class="text-gray-500 text-xl font-bold flex items-center"> <i class="fas fa-truck-loading"></i> 
            Loading Balles Expense
        </div>
        <br>
         
            <div class="container mx-auto flex flex-wrap items-center justify-between">
                <!-- Logo and Title -->
               
        
                <nav class="w-full md:w-auto mt-4 md:mt-0">
                    <ul class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4">
                        <li><a href="/HarvestingExpense/" class=" text-black font-bold hover:bg-green-700 px-3 py-2 rounded-md"><i class="fas fa-tractor"></i>
                            Harvesting</a></li>
                        <li><a href="/Dumping/" class=" text-black font-bold hover:bg-green-700 px-3 py-2 rounded-md"><i class="fas fa-dumpster"></i>
                            Dupming</a></li>
                         
                        <li><a href=" /PackingMaterial/" class=" text-black font-bold hover:bg-green-700 px-3 py-2 rounded-md"><i class="fas fa-box-open"></i>
                            Packing Material</a></li>
                            <li><a href=" /add_loading_labour_record/" class=" text-black font-bold hover:bg-green-700 px-3 py-2 rounded-md"><i class="fas fa-boxes"></i>
                                Loading Labour</a></li>
                         <li><a href="/add_expense/" class=" text-black font-bold hover:bg-green-700 px-3 py-2 rounded-md"><i class="fas fa-wallet"></i>
                            Other Expense</a></li>
                          <i class="fas fa-calculator text-2xl cursor-pointer" id="open-calculator" title="Open Calculator"></i>
                        
                        
                    </ul>
                    
                        
                        
                    </ul>
                    
                </nav>
               
            </div>
        
        
    
    <br>
     
       
    
    
  <div class="w-full lg:w-9/10 px-4 mx-auto mt-6">
    <div class="relative flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded-lg border-0">
      <div class="rounded-t bg-white mb-0 px-4 py-6">
         
         
      </div>
      <div class="flex-auto px-4 lg:px-6 py-6 pt-0">
        <form id="expense-form" class="space-y-6" action="/add_loading_labour_record/" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="flex items-center space-x-4">
                <i class="fas text-gray-500 fa-cog"></i>
                <label for="expense-type" class="block text-sm font-medium text-gray-700 w-1/3">Bunkar Name</label>
                <select name="name"   class="border-0 px-3 py-3 placeholder-black text-black bg-white rounded text-sm shadow focus:outline-none focus:ring w-full ease-linear transition-all duration-150" required hx-get="/Itemchecking/" hx-target="#saleform" hx-trigger="change">
                    <!-- Populate options dynamically from Django model -->
                    {% for saleproduct in productions %}
                    <option value="{{saleproduct.Manufacturing_Product_Name}}">{{saleproduct.Manufacturing_Product_Name}}</option>
                    {% endfor %}
                </select>
            </div>
             

            <!-- Conditional dropdown for Harvesting Type -->
            <div id="harvesting-type-container" class="space-y-4">
                <div class="flex items-center space-x-4">
                    <i class="fas  text-gray-500 fa-hard-hat"></i>
                    <label for="harvesting-type" class="block text-sm font-medium text-gray-700 w-1/3">Labour</label>
                    <select id="harvesting-type" name="team_leader" class="border-0 px-3 py-3 placeholder-black text-black bg-white rounded text-sm shadow focus:outline-none focus:ring w-full ease-linear transition-all duration-150">
                        {% for  loading in labour %}
                    <option value="{{ loading.id}}">{{ loading.Team_Leader}}</option>
                    {% endfor %}
                         
                    </select>
                </div>
            </div>

            <!-- Conditional fields for Fuel -->
            <div id="fuel-fields" class=" space-y-4">
                <div class="flex items-center space-x-4">
                    
                     <i class="fas text-gray-500 fa-weight"></i>

                    <label for="total-acre" class="block text-sm font-medium text-gray-700 w-1/3">Total Bales</label>
                    <input type="number" id="fuel-price" name="bales" placeholder="Total Balles" class="border-0 px-3 py-3 placeholder-black text-black bg-white rounded text-sm shadow focus:outline-none focus:ring w-full ease-linear transition-all duration-150">
                </div>
                <div class="flex items-center space-x-4">
                    <i class="fas fa-tachometer-alt text-gray-500"></i>
                    <label for="total-fuel" class="block text-sm font-medium text-gray-700 w-1/3">Per Bale Price</label>
                    <input type="number" id="total-fuel" name="per_bale_price" placeholder="Bale Price" class="border-0 px-3 py-3 placeholder-black text-black bg-white rounded text-sm shadow focus:outline-none focus:ring w-full ease-linear transition-all duration-150">
                </div>
            </div>
            

            <!-- Conditional fields for Without Fuel -->
            
            <!-- Amount Field -->
            <div class="flex items-center space-x-4">
                <i class="fas fa-calculator text-gray-500"></i>
                <label for="amount" class="block text-sm font-medium text-gray-700 w-1/3">Amount</label>
                <input type="number" id="amount" name="total_amount" placeholder="Total Amount" class="border-0 px-3 py-3 placeholder-black text-black bg-white rounded text-sm shadow focus:outline-none focus:ring w-full ease-linear transition-all duration-150" readonly required>
            </div>
            
            <div class="flex items-center space-x-4 mt-4">
                <label class="block text-sm font-medium text-gray-700 w-1/3">Payment Status</label>
                <div class="flex items-center">
                    <input type="radio" id="credit" name="payment_status" value="CREDIT" class="form-radio h-4 w-4 text-blue-600 transition duration-150 ease-in-out" onclick="togglePaidAmount()">
                    <label for="credit" class="ml-2 block text-sm font-medium text-gray-700">Credit</label>
                </div>
                <div class="flex items-center">
                    <input type="radio" id="paid" name="payment_status" value="PAID" class="form-radio h-4 w-4 text-blue-600 transition duration-150 ease-in-out" onclick="togglePaidAmount()">
                    <label for="paid" class="ml-2 block text-sm font-medium text-gray-700">Paid</label>
                </div>
            </div>
        
            <div id="paid-amount-container" class="hidden space-y-4">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-dollar-sign text-gray-500"></i>
                    <label for="paid-amount" class="block text-sm font-medium text-gray-700 w-1/3">Paid Amount</label>
                    <input type="number" id="paid-amount" step="0.2" name="paid_amount" placeholder="Paid Amount" class="border-0 px-3 py-3 placeholder-black text-black bg-white rounded text-sm shadow focus:outline-none focus:ring w-full ease-linear transition-all duration-150" oninput="calculateRemaining()" value="{{0.00}}">
                </div>
                <div class="flex items-center space-x-4">
                    <i class="fas fa-calculator text-gray-500"></i>
                    <label for="remaining-amount" class="block text-sm font-medium text-gray-700 w-1/3">Remaining Amount</label>
                    <input type="number" id="remaining-amount" step="0.2" name="remaining" placeholder="Remaining Amount" class="border-0 px-3 py-3 placeholder-black text-black bg-white rounded text-sm shadow focus:outline-none focus:ring w-full ease-linear transition-all duration-150" readonly value="{{0.00}}">
                </div>
            </div>
        
            <button type="submit" id="search-button" class="w-full bg-green-500 text-white py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium hover:bg-green-600 focus:outline-none focus:ring-indigo-500 focus:border-green-500 focus:ring-offset-2 focus:ring-indigo-500"><i class="fas fa-plus"></i> Add Expense</button>
        </form>
   
    </div>
    

 
   

    <!-- Calculator Modal -->
    <div id="calculator-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg shadow-lg p-4 w-80">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-semibold">Calculator</h2>
                <button id="close-calculator" class="text-gray-500 hover:text-gray-900">
                    <i class="fas fa-times"></i>
                </button>
            </div>
             
        </div>
    </div>
 
    
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script>
function data() {

return {

isSideMenuOpen: false,
toggleSideMenu() {
this.isSideMenuOpen = !this.isSideMenuOpen
},
closeSideMenu() {
this.isSideMenuOpen = false
},
isNotificationsMenuOpen: false,
toggleNotificationsMenu() {
this.isNotificationsMenuOpen = !this.isNotificationsMenuOpen
},
closeNotificationsMenu() {
this.isNotificationsMenuOpen = false
},
isProfileMenuOpen: false,
toggleProfileMenu() {
this.isProfileMenuOpen = !this.isProfileMenuOpen
},
closeProfileMenu() {
this.isProfileMenuOpen = false
},
isPagesMenuOpen: false,
togglePagesMenu() {
this.isPagesMenuOpen = !this.isPagesMenuOpen
},

}
}
</script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
         
      
        
        const fuelFields = document.getElementById('fuel-fields');
        const withoutFuelFields = document.getElementById('without-fuel-fields');
        const fuelPriceInput = document.getElementById('fuel-price');
        const totalFuelInput = document.getElementById('total-fuel');
        const totalAcreInput = document.getElementById('total-acre');
        const harvestPricePerAcreInput = document.getElementById('harvest-price-per-acre');
        const amountInput = document.getElementById('amount');

         

        

        fuelPriceInput.addEventListener('input', updateAmount);
        totalFuelInput.addEventListener('input', updateAmount);
        totalAcreInput.addEventListener('input', calculateAmount);
        harvestPricePerAcreInput.addEventListener('input', calculateAmount);

        function updateAmount() {
            const fuelPrice = parseFloat(fuelPriceInput.value) || 0;
            const totalFuel = parseFloat(totalFuelInput.value) || 0;
            amountInput.value = (fuelPrice * totalFuel).toFixed(2);
        }

        function calculateAmount() {
            const totalAcre = parseFloat(totalAcreInput.value) || 0;
            const pricePerAcre = parseFloat(harvestPricePerAcreInput.value) || 0;
            amountInput.value = (totalAcre * pricePerAcre).toFixed(2);
        }
    });
</script>
<script>
    document.getElementById('expense-form').addEventListener('submit', function() {
        document.getElementById('loader-overlay').style.display = 'flex';
    });

    window.addEventListener('loader', function() {
        document.getElementById('loader-overlay').style.display = 'none';
    });
</script>
<script>
    function togglePaidAmount() {
        const creditRadio = document.getElementById('credit');
        const paidAmountContainer = document.getElementById('paid-amount-container');
        const paidAmountInput = document.getElementById('paid-amount');
        const totalAmountInput = document.getElementById('amount');
        const remainingAmountInput = document.getElementById('remaining-amount');

        if (creditRadio.checked) {
            paidAmountContainer.classList.remove('hidden');
        } else {
            paidAmountContainer.classList.add('hidden');
            paidAmountInput.value = '';
            remainingAmountInput.value = totalAmountInput.value;
        }
    }

    function calculateRemaining() {
        const totalAmount = parseFloat(document.getElementById('amount').value) || 0;
        const paidAmount = parseFloat(document.getElementById('paid-amount').value) || 0;
        const remainingAmount = totalAmount - paidAmount;

        document.getElementById('remaining-amount').value = remainingAmount;
    }

    // Set remaining amount initially
    document.getElementById('remaining-amount').value = (document.getElementById('amount').value).toFixed(2);
</script>
  
{% endblock  %}